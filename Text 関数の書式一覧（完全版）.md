# 📘 **Text 関数の書式一覧（完全版）**

---

# 🧮 **1. 数値フォーマット（Number Format）**

## ■ 基本記号
| 記号 | 意味 |
|------|------|
| `0` | 必ず数字を表示（0 も表示） |
| `#` | 数字がある場合のみ表示 |
| `.` | 小数点 |
| `,` | 桁区切り（千区切り） |
| `%` | パーセント表示（値 ×100） |

---

## ■ よく使うパターン
| 書式 | 出力例（値 = 1234.5） |
|------|------------------------|
| `"0"` | `1235`（四捨五入） |
| `"0.00"` | `1234.50` |
| `"#,###"` | `1,235` |
| `"#,###.00"` | `1,234.50` |
| `"0%"` | `123450%` |
| `"0.00%"` | `123450.00%` |

---

## ■ 小数点の制御
| 書式 | 説明 |
|------|------|
| `"0.0"` | 小数1桁固定 |
| `"0.000"` | 小数3桁固定 |
| `"#.###"` | 小数最大3桁（不要な0は表示しない） |

---

## ■ 正負の書式を分ける
```
"#,###; -#,###"
```
- 正の値 → `#,###`
- 負の値 → `-#,###`

---

# 🕒 **2. 日付フォーマット（Date Format）**

## ■ 基本記号
| 記号 | 意味 |
|------|------|
| `yyyy` | 西暦4桁 |
| `yy` | 西暦2桁 |
| `MM` | 月（2桁） |
| `M` | 月（1〜2桁） |
| `dd` | 日（2桁） |
| `d` | 日（1〜2桁） |
| `hh` | 時（2桁・12時間） |
| `HH` | 時（2桁・24時間） |
| `mm` | 分 |
| `ss` | 秒 |
| `fff` | ミリ秒 |
| `AM/PM` | 午前/午後（ロケール依存） |
| `dddd` | 曜日（完全） |
| `ddd` | 曜日（短縮） |
| `mmmm` | 月名（完全） |
| `mmm` | 月名（短縮） |

---

## ■ よく使う日付パターン
| 書式 | 出力例（2026/01/06） |
|------|------------------------|
| `"yyyy/mm/dd"` | `2026/01/06` |
| `"yyyy-mm-dd"` | `2026-01-06` |
| `"mm/dd/yyyy"` | `01/06/2026` |
| `"dddd, mmmm d"` | `火曜日, 1月 6`（ロケール依存） |

---

## ■ 日付＋時刻
| 書式 | 出力例 |
|------|---------|
| `"yyyy/mm/dd HH:mm"` | `2026/01/06 05:28` |
| `"yyyy-mm-dd HH:mm:ss"` | `2026-01-06 05:28:00` |
| `"HH:mm:ss.fff"` | `05:28:00.123` |

---

# 💴 **3. 通貨フォーマット（Currency Format）**

## ■ シンプルな通貨
```
Text(123456, "¥#,###")
```
→ `¥123,456`

---

## ■ ロケール指定（推奨）
```
Text(123456, "[$-ja-JP]#,### 円")
```
→ `123,456 円`

```
Text(123456, "[$-en-US]$#,###.00")
```
→ `$123,456.00`

---

## ■ ロケールコード一覧（よく使う）
| ロケール | 言語 |
|---------|------|
| `ja-JP` | 日本語 |
| `en-US` | 英語（米国） |
| `en-GB` | 英語（英国） |
| `zh-CN` | 中国語（簡体） |
| `fr-FR` | フランス語 |

---

# 🌏 **4. ロケール（言語）指定の構文**

Text 関数は第3引数でロケールを指定できます。

```
Text(Today(), "dddd, mmmm d", "en-US")
```
→ `Tuesday, January 6`

```
Text(Today(), "dddd, mmmm d", "ja-JP")
```
→ `火曜日, 1月 6日`

---

# 🧭 **5. 実務でよく使う「完全版テンプレ」**

## ■ 金額（日本）
```
Text(Value, "[$-ja-JP]#,### 円")
```

## ■ ISO8601（システム連携）
```
Text(Now(), "yyyy-mm-ddTHH:MM:ss")
```

## ■ 日付（日本の一般的な表記）
```
Text(Today(), "yyyy年m月d日")
```

## ■ 日付（短縮）
```
Text(Today(), "yy/MM/dd")
```

## ■ 時刻（24時間）
```
Text(Now(), "HH:mm")
```

---

# 🎯 **6. Text 関数の書式指定まとめ（完全版）**

### ✔ 数値  
- `0` / `#`  
- `,`  
- `.`  
- `%`  
- 正負の書式分岐

### ✔ 日付  
- `yyyy` / `yy`  
- `MM` / `M`  
- `dd` / `d`  
- `HH` / `hh`  
- `mm` / `ss` / `fff`  
- `dddd` / `ddd`  
- `mmmm` / `mmm`  
- `AM/PM`

### ✔ 通貨  
- `¥`  
- `[$-ロケール]`  
- `#,###`  
- `#,###.00`

### ✔ ロケール  
- `"ja-JP"`  
- `"en-US"`  
- `"en-GB"`  
- `"fr-FR"`  
- `"zh-CN"`  
など多数

---

# 🔧 必要なら…

- **Text/Format/$ の最適な使い分けチャート**  
- **あなたのアプリのコードを Text 関数で統一するリファクタリング例**  
- **多言語対応の実装テンプレート**  

こういった実務的な資料も作れます。
