# 📘 **$"..."（文字列補間）の書式一覧（完全版）**

Power Fx では `$` は、**「文字列リテラルの拡張構文」**として扱われます。

Text や Format関数のように「書式指定子の体系」があるわけではなく、  
**`$"..."` の中で `{式:書式}` のように、Text/Format と同じ書式指定子を使う**  
という仕組みになっています。

つまり `$"..."` の書式一覧は、  
**「式の中で使える書式指定子（＝Text/Format と同じ）」**  
をまとめる形になります。

# 🧩 **1. 基本構文**

```
$"文字列 {式} 文字列"
```

式の中に書式を付ける場合：

```
$"金額は {Price:0,0} 円です"
```

---

# 🧮 **2. 数値フォーマット（Number Format）**

`{式:書式}` の「書式」部分は Text/Format と同じです。

## ■ 基本記号
| 記号 | 意味 |
|------|------|
| `0` | 必ず数字を表示 |
| `#` | 数字がある場合のみ表示 |
| `,` | 桁区切り |
| `.` | 小数点 |
| `%` | パーセント表示（×100） |

---

## ■ よく使うパターン
| 書式 | 例 | 出力 |
|------|------|-------|
| `{x:0}` | 1234.5 | `1235` |
| `{x:0.00}` | 1234.5 | `1234.50` |
| `{x:#,###}` | 1234.5 | `1,235` |
| `{x:#,###.00}` | 1234.5 | `1,234.50` |
| `{x:0%}` | 0.1234 | `12%` |
| `{x:0.00%}` | 0.1234 | `12.34%` |

---

## ■ 正負の書式を分ける
```
$"{Value:#,###; -#,###}"
```

---

# 🕒 **3. 日付フォーマット（Date Format）**

## ■ 基本記号
| 記号 | 意味 |
|------|------|
| `yyyy` | 西暦4桁 |
| `yy` | 西暦2桁 |
| `MM` | 月（2桁） |
| `M` | 月（1〜2桁） |
| `dd` | 日（2桁） |
| `d` | 日（1〜2桁） |
| `HH` | 時（24時間） |
| `hh` | 時（12時間） |
| `mm` | 分 |
| `ss` | 秒 |
| `fff` | ミリ秒 |
| `dddd` | 曜日（完全） |
| `ddd` | 曜日（短縮） |
| `mmmm` | 月名（完全） |
| `mmm` | 月名（短縮） |
| `AM/PM` | 午前/午後 |

---

## ■ よく使う日付パターン
| 書式 | 出力例 |
|------|---------|
| `{d:yyyy/MM/dd}` | `2026/01/06` |
| `{d:yyyy-MM-dd}` | `2026-01-06` |
| `{d:MM/dd/yyyy}` | `01/06/2026` |
| `{d:dddd, mmmm d}` | `火曜日, 1月 6`（ロケール依存） |

---

## ■ 日付＋時刻
```
$"{Now():yyyy/MM/dd HH:mm:ss}"
```

---

# 💴 **4. 通貨フォーマット（Currency Format）**

ロケール指定も可能です。

## ■ 日本円
```
$"金額: {Price:[$-ja-JP]#,### 円}"
```

## ■ 米ドル
```
$"Price: {Price:[$-en-US]$#,###.00}"
```

---

# 🌏 **5. ロケール（言語）指定**

```
$"Today is {Today():[$-en-US]dddd, mmmm d}"
```

---

# 🧭 **6. $"..." の実務テンプレ（完全版）**

## ■ ユーザー名入りメッセージ
```
$"こんにちは、{User().FullName} さん"
```

## ■ 金額表示
```
$"合計金額は {Total:0,0} 円です"
```

## ■ 日付表示
```
$"作成日: {ThisItem.Created:yyyy/MM/dd}"
```

## ■ メール本文
```
$"
お疲れ様です {User().FullName} さん。
本日の売上は {Sum(Sales, Amount):#,### 円} です。
"
```

---

# 🎯 **7. $"..." の書式指定まとめ（完全版）**

### ✔ 数値  
- `0` / `#`  
- `,`  
- `.`  
- `%`  
- 正負の書式分岐

### ✔ 日付  
- `yyyy` / `yy`  
- `MM` / `M`  
- `dd` / `d`  
- `HH` / `hh`  
- `mm` / `ss` / `fff`  
- `dddd` / `ddd`  
- `mmmm` / `mmm`  
- `AM/PM`

### ✔ 通貨  
- `[$-ロケール]`  
- `#,###`  
- `#,###.00`  
- `¥` / `$` など

### ✔ ロケール  
- `"ja-JP"`  
- `"en-US"`  
- `"en-GB"`  
- `"fr-FR"`  
- `"zh-CN"`  
など多数

---

# 🔧 必要なら…

- **Text / Format / $"..." の完全比較表**  
- **あなたのアプリのコードを $"..." で読みやすくするリファクタ例**  
- **多言語対応テンプレートの作成**  

こういった資料も作れます。
